!function($){var ns="register";$.fn[ns]=function(option){var cRegister=$(this);option=option||{},LT.File.Js.load("//concat.lietou-static.com/dev/www/pc/revs/v1/js/plugins/jquery.validTip_469fb75b.js,//concat.lietou-static.com/core/pc/revs/js/common/plugins/jquery.valid_7b182f96.js",function(){function countdown(elm,time){if(!elm)return!1;var start=time||60,timer=null;elm.removeClass("btn-primary").addClass("btn-disabled"),function(){return start--,elm.html("重新获取（"+start+"）"),0>=start?(elm.removeClass("btn-disabled").addClass("btn-primary").html("重新获取"),clearTimeout(timer),!1):void(timer=setTimeout(arguments.callee,1e3))}()}var phoneCodeWrap=$('[data-selector="phone-code-wrap"]',cRegister),phoneCodeBtn=$('[data-selector="phone-code-btn"]',phoneCodeWrap).data("times",0),checkUserReg=$('[data-selector="user-reg"]',cRegister);phoneCodeBtn.bind("click",function(){if($(this).hasClass("btn-disabled"))return!1;if(!checkUserReg.attr("data-valid")||"false"===checkUserReg.attr("data-valid"))return checkUserReg.trigger("highlight",!0).trigger("focus"),!1;var $this=$(this),times=$this.data("times")-0;return"1"===LT.Cookie.get("phone_code_times")?(checkUserReg.SimpleValidErrorTips("发送次数过多，请明天重试"),!1):times>=3?($this.data("times",0),LT.Cookie.set("phone_code_times","1",1/24/2),checkUserReg.SimpleValidErrorTips("发送次数过多，请明天重试"),!1):void LT.ajax({url:LT.Env.passportRoot+"c/sendverifymessage.json?__mn__=newtel",type:"POST",data:"newtel="+$.trim(checkUserReg.val()),dataType:"json",success:function(data){1===data.flag?(times++,$this.data("times",times),countdown($this)):$.dialog.error(data.msg)},error:function(err){$.dialog.error(err.msg)}})}),cRegister.valid({scan:function(data){data.valid?cRegister.find(".text-error").removeClass("text-error"):($.each(data.result,function(i,n){!n.valid&&n.element.trigger("highlight",!0)}),data.firstError.element.triggerHandler("focus"))},success:function(){var $this=cRegister,_pw=$('[name="user_pwd"]',cRegister),_pw_val=_pw.val();return/\b(000000|111111|11111111|112233|123123|123321|123456|12345678|654321|666666|888888|1234567)\b/.test(_pw_val)?(_pw.SimpleValidErrorTips("密码安全度低，请更换密码"),!1):/"|'|<|>|\?|\%|\*/g.test(_pw_val)?(_pw.SimpleValidErrorTips("请使用常用符号"),!1):(LT.ajax({url:$this.attr("action")||LT.Env.passportRoot+"c/reg.json",type:$this.attr("method")||"POST",data:$this.serializeArray(),dataType:"json",cache:!1,success:function(data){if(data&&1===data.flag)if(option.callback)option.callback(data);else{var srId="";cRegister.attr("sr_id")&&(srId="?sr_id="+cRegister.attr("sr_id")),window.location.href=LT.Env.wwwRoot+"user/regc/regnamecard/"+srId}else data.msg.indexOf("验证码")>=0?$('input[name="verifycode"]',$this).SimpleValidErrorTips(data.msg):$('[data-selector="user-reg"]',$this).SimpleValidErrorTips(data.msg)},mask:$(":submit",$this)}),!1)}}),$("[validate-rules]",cRegister).SimpleValidTips()})}}(jQuery),function($){var ns="login";$.fn[ns]=function(option){var cLoginForm=$(this);option=option||{},LT.File.Js.load("//concat.lietou-static.com/dev/www/pc/revs/v1/js/plugins/jquery.validTip_469fb75b.js,//concat.lietou-static.com/core/pc/revs/js/common/plugins/jquery.valid_7b182f96.js",function(){cLoginForm.valid({scan:function(data){data.valid?cLoginForm.find(".text-error").removeClass("text-error"):($.each(data.result,function(i,n){!n.valid&&n.element.trigger("highlight",!0)}),data.firstError.element.triggerHandler("focus"))},success:function(){var data,$this=cLoginForm,user_login=$("input[name='user_login']",$this),user_pwd=$("input[name='user_pwd']",$this),pwd=user_pwd.val();return user_pwd.val(LT.String.md5(pwd)),data=$this.serializeArray(),LT.ajax({url:$this.attr("action")||LT.Env.passportRoot+"c/login.json",type:$this.attr("method")||"POST",data:data,dataType:"json",cache:!1,success:function(data){switch(data.flag){case 1:option.callback?option.callback(data):data.data.url?location.href=data.data.url:location.href=LT.Env.wwwRoot+"home/";break;case 0:user_login.SimpleValidErrorTips(data.msg);break;default:$.dialog.alert("发生未知错误，请与系统管理员联系，错误代码：(INDEX:LOGIN_"+data.code+")")}},mask:$(":submit",$this)}),!1}}),$("[validate-rules]").SimpleValidTips()})}}(jQuery);